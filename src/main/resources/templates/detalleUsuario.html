<!DOCTYPE html>
<!--
Click nbfs://nbhost/SystemFileSystem/Templates/Licenses/license-default.txt to change this license
Click nbfs://nbhost/SystemFileSystem/Templates/Other/html.html to edit this template
-->
<html  xmlns:th="http://www.thymeleaf.org">
    <head>
        <title>TODO supply a title</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js" integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI" crossorigin="anonymous"></script>

        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.13.1/font/bootstrap-icons.min.css">
        <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
        <style>

            #usuario1{

                object-fit: contain;

                transition: all 200ms ease-in-out;
                margin: 2rem 0;
                /*border: double 5px black;*/
                box-shadow: 2px 4px 3px #b4b1bd;
                border-radius: 5px;
                /*z-index: 2;*/

            }

            #usuario1:hover{
                opacity: 0.5;
                cursor: pointer;
            }

            #btnAddImg{
                position:absolute;
                display: inline-block;
                width: 30vh;
                height: 20vh;
                background-color: red;
                z-index: 1;
            }


            #info-user > p{
                transition: all 450ms ease-in-out;
                border-radius: 5px;
                padding: 0 3px;
                /*                display: inline-block;*/
            }

            #info-user > p:hover{
                transform: scale(1.3) ;
                background-color: lightblue;
                z-index: 1;

            }

            .correct{

                box-shadow: 0 0 10px  green;

            }

            .correct:focus{
                box-shadow: 0 0 10px  green;
            }







            .invalidText{
                box-shadow: 0 0 10px red;

            }

        </style>
    </head>
    <body class="row w-100 h-100" style="overflow-x:hidden">

        <!--<br>-->
        <!--SECCION DE USUARIO-->
        <section class="card col-12 col-sm-12 col-md-12 col-lg-4 col-xl-4 mb-3 text-break" style="align-items: center; height: 99dvh" id="Seccion-Usuario" >
            <!--            <div class="card-title" id="usuario1" style="border:none">-->

            <div class="container h-25 w-50 text-center" id="contenedor-img" style="height: 33vh">

                <img class="card-img-top h-75 w-75" id="usuario1" th:if="${Errores == null}" th:src="${Usuario.imagen != null ? 'data:image/*; base64,'+Usuario.imagen : 'https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTNT31I-b-Jdf8bjPM-mm-V1qCpb-oudRLvtw&s'}">
            </div>



            <!--</div>-->

            <div class="card-title text-center fw-bold btn btn-primary" th:if="${Errores == null}" disabled th:text="|${Usuario.nombre} ${Usuario.apellidoPaterno} ${Usuario.apellidoMaterno}|" style="z-index: 101"></div>
            <div class="card-body" id="info-user">

                <!--<div class="text-center" style="font-weight: 600; font-size: 1.5rem;">INFORMACION</div>-->
                <p th:utext="|<b>Email:</b> ${Usuario.email}|" th:if="${Errores == null}"></p>

                <p  th:utext="|<b>Fecha Nacimiento:</b> ${Usuario.fechaNacimiento}|" th:if="${Errores == null}"></p>
                <p th:utext="|<b>Rol:</b> ${Usuario.rol.idRol}|"th:if="${Errores == null}"></p>
                <p th:utext="|<b>Sexo:</b> ${Usuario.sexo}|"th:if="${Errores == null}"></p>
                <p th:utext="|<b>Telefono:</b> ${Usuario.telefono}|"th:if="${Errores == null}"></p>
                <p th:utext="|<b>Celular:</b> ${Usuario.celular}|"th:if="${Errores == null}"></p>
                <p th:utext="|<b>Curp:</b> ${Usuario.curp}|"th:if="${Errores == null}"></p>

                <!--<a href="url" class="btn btn-warning col-12" th:href="@{/Usuario/formularioEditable?idUsuario=}+${Usuario.idUsuario}">Editar</a>-->

                <button class="btn btn-warning w-100 mb-3"  onclick="cargarRol()"  data-bs-toggle="modal" data-bs-target="#my-modal" id="btnEditarUsuario" >Editar</button>


                <button class="btn btn-outline-secondary mb-3 col-12" id="btnFoto">Cambiar Foto</button>
                <form  th:if="${Errores == null}" enctype="multipart/form-data" th:Object="${Usuario}"  method="POST" th:action="@{/Usuario/ImagenPerfil}">
                    <input type="file" hidden id="inputImg" name="imagenInput" class="mb-3"accept="image/*">
                    <input type="hidden" th:field="${Usuario.idUsuario}">
                    <button hidden type="submit" id="btnSubImg"></button>
                </form>
            </div>




        </section>
        <!--<br>-->
        <!--SECCION DE DIRECCION-->
        <section th:if="${Errores == null}" class="container col-12 col-sm-12 col-md-12 col-lg-7 col-xl-8 " id="Seccion-Direccion" style="height: 99dvh; display: flex;">
            <div class="card w-100">
                <div class="card-body">
                    <div class="card-title text-center"  style="font-weight: bold; font-size: 2rem">DIRECCIONES</div>
                    <table class="table table-striped-columns" th:if="|${#lists.size(Usuario.direcciones)>0}|">

                        <!--<th class="col-10 table-primary">#</th>-->
                        <th class="col-9 text-center">Direccion</th>
                        <th class="col-3">Accion</th>
                        <tbody class="table-group-divider">
                            <tr th:each="direccion:${Usuario.Direcciones}">

                                <td  th:text="|${direccion.calle} ${direccion.numeroInterior} ${direccion.numeroExterior}|"></td>
                                <td class="text-center">

                                    <div class="btn-group">
                                        <!--BOTON EDITAR DEL MODAL DIRECCION-->
                                        <button class="btn btn-warning"  data-bs-toggle="modal" data-bs-target="#modalDireccion" id="btnEditarDireccion" th:onclick="|EditarDireccion(${Usuario.idUsuario},${direccion.idDireccion})|">
                                            <!--@{/Usuario/formularioEditable?idUsuario=}+${Usuario.idUsuario}-->
                                            <i class="bi bi-pencil-square"></i>
                                        </button>

                                        <button th:onclick="|EliminarDireccion(${Usuario.idUsuario},${direccion.idDireccion})|" class="btn btn-danger">
                                            <i class="bi bi-x-square"></i>
                                        </button>
                                        <!--                                        <a th:onclick="|EliminarDireccion(${Usuario.idUsuario},${direccion.idDireccion})|" class="btn btn-danger" th:href="@{/Usuario/direccion/delete/{idDireccion}/{idUsuario} (
                                                                                    idDireccion = ${direccion.idDireccion},idUsuario=${Usuario.idUsuario}
                                                                                    )}">
                                                                                    <i class="bi bi-x-square"></i>
                                                                                </a>-->
                                    </div>

                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <button class="col-sm-12 col-xs-12  col-md-4 btn btn-success" data-bs-toggle="modal" data-bs-target="#modalDireccion" id="btnAgregarDireccion" th:onclick="AgregarDireccion()">Agregar nueva dirección</button>
                </div>
            </div>


            <!--<button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#my-modal">Ver modal</button>--> 
        </section>


        <!--MODAL USUARIO-->
        <section class="modal fade" id="my-modal" style="padding: 0">
            <div class="modal-dialog modal-fullscreen">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title">Editar usuario</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close" th:onclick="|cerrarModal(${Usuario.idUsuario})|"></button>
                    </div>
                    <!--CUERPO DEL MODAL-->
                    <div class="modal-body">




                        <form class="needs-validation"  method="post" th:object="${Usuario}" th:action="@{/Usuario/add}"style="margin:2rem; flex-direction: column">

                            <!--<input type="hidden" th:field="${Usuario.Direcciones[0].idDireccion}">-->
                            <input type="hidden" th:field="${Usuario.idUsuario}">
                            <input type="hidden" th:field="${Usuario.estatus}">



                            <!--SECCION DEL USUARIO-->
                            <section class="container" style="" >


                                <div class=" row" style="">

                                    <span class="container">
                                        <i class="bi bi-person-circle "></i>
                                        <b>Nombres:</b>
                                    </span>
                                    <!--INPUT NOMBRE-->
                                    <input type ="text" placeholder="Nombres" id="input-nombre"class="form-control " th:field="*{nombre}" onkeypress="soloLetras(event, this)" required >  

                                    <span class="error-message mb-3 " style="font-size: 0.8rem" />
                                    <!--<span class="text-danger mb-3 "  th:if="${#fields.hasErrors('nombre')}" th:errors="${Usuario.nombre}" style="font-size: 0.8rem" />-->
                                    <span class="text-danger mb-3 "  th:if="${Errores != null} AND ${error.field == 'nombre'}" th:each="error : ${Errores}"
                                          th:text="${error.defaultMessage}"style="font-size: 0.8rem" />
                                </div>

                                <div class="row" style="" >
                                    <span class="fw-bold">Apellido Paterno:</span>
                                    <!--INPUT APELLIDO-->
                                    <input type="text" class="form-control mb-3" id="input-aPaterno" placeholder="Paterno"  th:field="*{apellidoPaterno}" required  onkeypress="soloLetras(event, this)">
                                    <span class="text-danger " style="font-size: 0.8rem" th:if="${Errores != null} AND ${error.field == 'apellidoPaterno'}" th:each="error:${Errores}" 
                                          th:text="${error.defaultMessage}"/>
                                    <!--<span class="text-danger mb-3 "  th:if="${#fields.hasErrors('apellidoPaterno')}" th:errors="${Usuario.apellidoPaterno}" style="font-size: 0.8rem" />-->
                                </div>
                                <div class="row" style="" >
                                    <span class="fw-bold">Apellido Materno:</span>
                                    <!--INPUT APELLIDO-->
                                    <input type="text" class="form-control" id="input-aMaterno"placeholder="Materno" th:field="*{apellidoMaterno}" required  onkeypress="soloLetras(event, this)">
                                    <span class="error-message row" style="font-size: 0.8rem" />
                                    <span class="text-danger row" style="font-size: 0.8rem;" th:if="${Errores != null} AND ${error.field == 'apellidoMaterno'}" th:each="error:${Errores}"
                                          th:text="${error.defaultMessage}"/>
                                </div>



                                <br>


                                <div class="row mb-3" style="">
                                    <span class="fw-bold">
                                        <i class="bi bi-envelope"></i> 
                                        Correo:

                                    </span>
                                    <!--INPUT EMAIL-->
                                    <input id="input-email" type="text" class="form-control " placeholder="Correo" th:field="*{email}" required  onblur="emailValidator(this)">
                                    <span class="text-danger " style="font-size: 0.8rem;" th:if="${Errores != null} AND ${error.field == 'email'}" th:each="error:${Errores}"
                                          th:text="${error.defaultMessage}"/>
                                    <span id="emailMessage" ></span>
                                </div>


                                <!--INPUT PASSWORD-->
                                <input id="input-password" type="hidden" placeholder="contraseña" class="form-control" th:field="*{password}" onblur="passVal(this)">
                                <span class="tetx-danger" style="font-size:0.8rem" th:if="${Errores != null} AND ${error.field == 'password'}"th:each="error:${Errores}"
                                      th:text="${error.defaultMessage}"/>





                                <div class="row mb-3" style="">

                                    <span class="input-group-text fw-bold"> <i class="bi bi-telephone"></i>Telefono:</span>
                                    <!--INPUT TELEFONO-->
                                    <input id="input-telefono" type = "number" placeholder="Telefono" class="form-control " th:field="*{telefono}"  required  onblur="validarNumero(this)">

                                    <span class="error-message mb-3 row" style="font-size: 0.8rem" />
                                    <span class="text-danger  row" style="font-size: 0.8rem" th:if="${Errores != null} AND ${error.field == 'telefono'}" th:each="error:${Errores}"
                                          th:text="${error.defaultMessage}"/>

                                </div>

                                <div class="row" style="">

                                    <span class="input-group-text fw-bold" > <i class="bi bi-phone"></i>celular</span>
                                    <!--INPUT CELULAR-->
                                    <input id="input-celular" type = "number" placeholder="Celular" class="form-control" th:field="*{celular}"  required  onblur="validarNumero(this)">
                                    <span class="error-message mb-3 row" style="font-size: 0.8rem" />
                                    <span class="text-danger  row" style="font-size: 0.8rem" th:if="${Errores!= null} AND ${error.field == 'celular'}" th:each="error:${Errores}"
                                          th:text="${error.defaultMessage}"/>
                                </div>

                                <br>


                                <div class="row mb-3" onmouseleave="validarSexo()" style="">
                                    <span class="input-group-text fw-bold ">Sexo:</span>
                                    <span class="input-group-text  col-3">Femenino:</span>
                                    <div class="input-group-text col-1" style="background-color:#A8BCD1">
                                        <!--INPUT SEXO F-->
                                        <input type = "radio" value="F" id="femenino" name="sexo" class="form-check-input mt-0" th:field="*{sexo}"  th:checked="*{sexo}">
                                    </div>
                                    <span class="input-group-text  col-3">Masculino:</span>
                                    <div class="input-group-text col-1" style="background:#A8BCD1 ">
                                        <!--INPUT SEXO M-->

                                        <input type = "radio" value="M" id="masculino" name="sexo" class="form-check-input mt-0" th:field="*{sexo}" th:checked="*{sexo}" >
                                    </div>
                                </div>
                                <span class="text-danger  row" style="font-size: 0.8rem" th:if="${Errores!= null} AND ${error.field == 'sexo'} " th:each="error:${Errores}"
                                      th:text="${error.defaultMessage}"/>



                                <div class="row mb-3" style="">
                                    <label class="input-group-text fw-bold ">Fecha de Nacimiento:</label>
                                    <input id="input-fechaNacimiento" type = "date" class="form-control col-sm-8 col-md-6" th:field="*{fechaNacimiento}"  onblur="validarNacimiento(this)">
                                    <span class="error-message mb-3 row" style="font-size: 0.8rem" />
                                    <span class="text-danger  row" style="font-size: 0.8rem"  th:if="${Errores != null} AND ${error.field=='fechaNacimiento'}" th:each="error:${Errores}"
                                          th:text="${error.defaultMessage}"/>

                                </div>






                                <div class="row" style="">
                                    <label class="input-group-text fw-bold">CURP:</label>
                                    <!--INPUT CORREO-->
                                    <input id="input-curp" type = "text" placeholder="CURP" class="form-control col-10" th:field="*{curp}" onblur="validarCurp(this)"> 
                                    <span class="error-message mb-3 row" style="font-size: 0.8rem" />
                                    <span class="text-danger  row" style="font-size: 0.8rem" th:if="${Errores != null} AND ${error.field=='curp'}" th:each="error:${Errores}"/>

                                </div>

                                <div class="row" style="" >
                                    <span  class="input-group-text fw-bold">Rol:</span>
                                    <select class="form-control" id = "rolddl"th:field="*{rol.idRol}" onblur="validarRol(this)">
                                        <option value=0>Elige tu rol</option>
                                        <option th:each="rol:${Roles}"  th:text="${rol.nombre}" th:value="${rol.idRol}" ></option>
                                    </select>
                                    <span class="error-message mb-3 row" style="font-size: 0.8rem" />
                                    <span class="text-danger mb-3 row" style="font-size: 0.8rem" th:if="${Errores != null} AND ${error.field=='rol'}" th:each="error:${Errores}" />

                                </div>




                            </section >

                            <div class="text-center">

                                <button type="submit" class="btn  btn-outline-success col-2">Guardar</button> 

                            </div>



                        </form>



                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-danger" id="cerrarModalUsuario" th:onclick="|cerrarModal(${Usuario.idUsuario})|" data-bs-dismiss="modal">Cerrar</button>
                    </div>
                </div>
            </div>
        </section>





        <!--MODAL DIRECCION-->
        <section class="modal fade" id="modalDireccion" style="padding: 0">
            <div class="modal-dialog modal-fullscreen">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title">DIRECCIÓN </h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close" th:onclick="|cerrarModal(${Usuario.idUsuario})|"></button>
                    </div>
                    <!--CUERPO DEL MODAL DIRECCION-->
                    <div class="modal-body">




                        <form  method="post" th:object="${Usuario}" th:action="@{/Usuario/add}" style="margin:2rem; flex-direction: column">

                            <input type="hidden" th:field="${Usuario.idUsuario}">
                            <input type="hidden" id="hiddenDirId" th:field="${Usuario.Direcciones[0].idDireccion}">





                            <!--SECCION DE LA DIRECCION-->
                            <section class="container ">

                                <h3 style="font-weight: bold"></h3>

                                <!--APARTADO DE CALLE-->
                                <div class="row mb-3" style="">
                                    <label class="input-group-text fw-bold">calle</label>
                                    <!--INPUT-->
                                    <input type="text" class="form-control mb-3" id="Dircalle" th:field="${Usuario.direcciones[0].calle}"  onblur="validarCalle(this)">

                                    <span class="error-message mb-3 row" id="calleMensaje" style="font-size: 0.8rem" />
                                    <!--<span class="text-danger mb-3 row" style="font-size: 0.8rem" th:if="${#fields.hasErrors('direcciones[0].calle')}" th:errors="$(direcciones[0].calle)"/>-->
                                    <span class="text-danger"  th:if="${ErroresEditarDireccion != null} AND ${error.field == 'direcciones[0].calle'}" th:each="error : ${ErroresEditarDireccion}"
                                          th:text="${error.defaultMessage}"style="font-size: 0.8rem" />
                                </div>

                                <!--APARTADO DE NUMERO INTERIOR-->
                                <div class="row  mb-3" style="">
                                    <label class="input-group-text fw-bold">No.Interior</label>

                                    <!--INPUT-->
                                    <input type="text" id="noInterior" class="form-control" th:field="*{direcciones[0].numeroInterior}"  onblur="validarNumeroCalle(this)" required>
                                    <span class="error-message row" id="numeroIntMensaje" style="font-size: 0.8rem" />
                                    <span class="error-message text-danger row" style="font-size: 0.8rem" th:if="${ErroresEditarDireccion != null} AND ${error.field =='direcciones[0].numeroInterior'}" th:each="error : ${ErroresEditarDireccion}" th:text="${error.defaultMessage}" />
                                </div>

                                <!--APARTADO DE NUMERO EXTERIOR-->
                                <div class="row  mb-3" style="">
                                    <!--INPUT-->
                                    <label class="input-group-text fw-bold">No.Exterior</label>
                                    <input type="text" id="noExterior" class="form-control" th:field="*{direcciones[0].numeroExterior}"  onblur="validarNumeroCalle(this)" required>
                                    <span class="error-message row" id="numeroExtMensaje" style="font-size: 0.8rem" />
                                    <span class="text-danger error-message row" style="font-size: 0.8rem" th:if="${ErroresEditarDireccion != null} AND ${error.field =='direcciones[0].numeroExterior'}"  th:each="error:${ErroresEditarDireccion}" th:text="${error.defaultMessage}" />
                                    <!--<span class="error-message mb-3 row" style="font-size: 0.8rem" />-->

                                </div>

                                <!--                                <div class="row mb-3" style="">
                                
                                                                    <label class="input-group-text fw-bold ">Id Colonia</label>
                                
                                                                    INPUT
                                                                    <input type="text"  id="idCol" class="form-control " th:field="*{direcciones[0].colonia.idColonia}">
                                
                                                                </div>-->
                                <!--APARTADO DE PAIS-->
                                <div class="row  mb-3" style="">
                                    <label class="input-group-text fw-bold" >Pais:</label>
                                    <select class="form-control" id="ddlPais" onchange="paisddl()" required>
                                        <option value="0">Elige un pais de la lista</option>
                                        <option th:each="pais:${Paises}" th:value="${pais.idPais}" th:text="${pais.nombre}"></option>
                                        <!--<option  th:value="${pais.idPais}" th:text="${pais.Nombre}"></option>-->
                                    </select>
                                    <label class="error-message text-danger" th:if="${ErroresEditarDireccion != null} AND ${error.field == '${direcciones[0].colonia.municipio.estado.pais}' }" th:each="error:${ErroresEditarDireccion}"/>
                                </div>

                                <!--APARTADO DE ESTADO-->
                                <div class="row mb-3">
                                    <label class="input-group-text fw-bold" >Estado:</label>
                                    <select  class="form-control" id="ddlEstado" onchange="cambiarEstado()" required>
                                        <option value=0>Selecciona un Estado</option>

                                    </select>
                                    <label class="error-message text-danger" th:if="${ErroresEditarDireccion != null} AND ${error.field == '${direcciones[0].colonia.municipio.estado}' }" th:each="error:${ErroresEditarDireccion}"/>
                                </div>

                                <!--APARTADO DE MUNCIPIO-->

                                <div class="row mb-3">
                                    <label class="input-group-text fw-bold " >Municipio:</label>
                                    <select  class="form-control" id="ddlMunicipio" onchange="cambiaMunicipio()" th:field="*{direcciones[0].colonia.municipio.idMunicipio}" required>
                                        <option value=0>Selecciona un Municipio</option>
                                    </select>
                                    <label class="error-message text-danger" th:if="${ErroresEditarDireccion != null} AND ${error.field == '${direcciones[0].colonia.municipio}' }" th:each="error:${ErroresEditarDireccion}"/>
                                </div>

                                <!--APARTADO DE COLONIA-->

                                <div class="row mb-3">
                                    <label class="input-group-text fw-bold" >Colonia:</label>
                                    <select class="form-control" id="ddlColonia" th:field="*{direcciones[0].colonia.idColonia}" required>
                                        <option value=0>Selecciona la Colonia</option>
                                    </select>
                                    <label class="error-message text-danger" th:if="${ErroresEditarDireccion != null} AND ${error.field == '${direcciones[0].colonia}' }" th:each="error:${ErroresEditarDireccion}"/>
                                </div>







                                <button type="submit" id="btnSubmitDireccion" class="btn btn-success col-12">Guardar</button> 
                            </section>
                            <!--                                <button type="submit" class="btn btn-success col-12" th:if="${(Usuario.idUsuario !=0 && Usuario.direcciones[0].IdDireccion > 0 )}">Editar</button> -->





                        </form>



                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-danger" data-bs-dismiss="modal" th:onclick="|cerrarModal(${Usuario.idUsuario})|">Cerrar</button>

                    </div>
                </div>
            </div>
        </section>


        <!--SCRIPTS-->
        <script src="https://code.jquery.com/jquery-3.7.1.js" integrity="sha256-eKhayi8LEQwp4NKxN+CfCh+3qOVUtJn3QNZ0TciWLP4=" crossorigin="anonymous"></script>
        <script></script>
        <script>
                                        function soloLetras(event, input) {

                                        let key = event.key;
                                        let regExpres = /[a-zA-ZÁÉÍÓÚáéíóú ]+/;
                                        let ascci = event.charCode;
                                        if (ascci == 32 || ascci >= 65 && ascci <= 90 || ascci >= 97 && ascci <= 122) {
                                        if (regExpres.test(key)) {
                                        $(input).removeClass("invalidText").addClass("correct");
                                        $(input).siblings(".error-message").text("");
                                        }

                                        } else {
                                        $(input).removeClass("correct").addClass("invalidText");
                                        $(input).siblings(".error-message").text(" Solo se permiten letras");
                                        setTimeout(() => {
                                        $(input).removeClass("invalidText");
                                        $(input).siblings(".error-message").text("");
                                        }, 3000);
                                        event.preventDefault();
                                        }


                                        }


                                        function emailValidator(thisInput) {
                                        let cadena = $(thisInput).val();
                                        const regExpres = /^([A-Z|a-z|0-9](\.|_){0,1})+[A-Z|a-z|0-9]\@([A-Z|a-z|0-9])+((\.){0,1}[A-Z|a-z|0-9]){2}\.[a-z]{2,3}$/;
                                        if (regExpres.test(cadena)) {
                                        console.log("Correo valido");
                                        $(thisInput).removeClass("invalidText").addClass("correct");
                                        $("#emailMessage").text("");
                                        setTimeout(() => {
                                        $(thisInput).removeClass("correct");
                                        }, 5000);
                                        } else {
                                        $(thisInput).addClass("invalidText");
                                        $("#emailMessage").text("Correo no valido");
                                        console.log("Correo no valido");
                                        //                        setTimeout(() => {
                                        //
                                        //                        $("#emailMessage").text("");
                                        ////                        $(thisInput).removeClass("invalidText");
                                        //                        }, 5000);
                                        }
                                        }

                                        function passVal(thisInput) {
                                        const regEx = /^(?=.*\d)(?=.*[a-z])(?=.*[A-Z])(?=.*[a-zA-Z]).{8,}$/;
                                        const inputText = $(thisInput).val();
                                        if (regEx.test(inputText) && inputText.length < 50) {
                                        $(thisInput).siblings(".error-message").text("");
                                        $(thisInput).removeClass("invalidText").addClass("correct");
                                        //                                $(thisInput).siblings(".error-message").text("Correcto");
                                        setTimeout(() => {
                                        $(thisInput).removeClass("correct");
                                        }, 3700);
                                        console.log("Contraseña valida");
                                        } else {

                                        $(thisInput).removeClass("correct").addClass("invalidText");
                                        $(thisInput).siblings(".error-message").text("Contraseña no valida");
                                        //                        setTimeout(() => {
                                        ////                                                             $(thisInput).removeClass("invalidText");
                                        ////                        $(thisInput).siblings(".error-message").text("");
                                        //                        }, 3700);
                                        console.log("Contraseña no valida");
                                        console.log("Escribe una contraseña más corta");
                                        }


                                        }
                                        function validarNumero(thisInput) {

                                        const regExp = /^\s*(?:\+?(\d{1,3}))?([-. (]*(\d{3})[-. )]*)?((\d{3})[-. ]*(\d{2,4})(?:[-.x ]*(\d+))?)\s*$/;
                                        const cadena = $(thisInput).val();
                                        if (regExp.test(cadena) && cadena.length < 12) {
                                        $(thisInput).siblings(".error-message").text("");
                                        $(thisInput).removeClass("invalidText").addClass("correct");
                                        //                                $(thisInput).siblings(".error-message").text("Correcto");
                                        setTimeout(() => {
                                        $(thisInput).removeClass("correct");
                                        }, 3700);
                                        } else {
                                        $(thisInput).removeClass("correct").addClass("invalidText");
                                        $(thisInput).siblings(".error-message").text("Numero no valido");
                                        }


                                        }
                                        function validarNumeroCalle(thisInput) {

                                        const regExp = /^[+-]?(\.\d+|\d+\.|\d+|\d+\.?\d+|\d*\.?\d*[Ee][+-]?\d*)$/;
                                        const cadena = $(thisInput).val();
                                        if (regExp.test(cadena) && cadena.length < 6 && cadena.length > 0) {
                                        $(thisInput).siblings(".error-message").text("");
                                        $(thisInput).removeClass("invalidText").addClass("correct");
                                        //                                $(thisInput).siblings(".error-message").text("Correcto");
                                        setTimeout(() => {
                                        $(thisInput).removeClass("correct");
                                        }, 3700);
                                        } else {
                                        $(thisInput).removeClass("correct").addClass("invalidText");
                                        $(thisInput).siblings(".error-message").text("Solo se permiten numeros enteros");
                                        }


                                        }

                                        function validarSexo() {
                                        const seleccionado = $('input[name = "sexo"]:checked');
                                        if (seleccionado.length == 0) {
                                        console.log("Selecciona una opción");
                                        }


                                        }

                                        function validarNacimiento(thisInput) {
                                        const fecha = $(thisInput).val();
                                        const regEx = /([\d]+)([\-\./])([\d]+)([\-\./])([\d]+)|((Jan(|uary)|Feb(|ruary)|Mar(|ch)|Apr(|il)|May|Jun(|e)|Jul(|y)|Aug(|ust)|Sept(|ember)|Oct(|ober)|(Nov|Dec)(|ember))([\s\-])(|([\d]+){1,2}([\s\-]|\, ))([\d]+){4})/;
                                        let dia = (new Date().getUTCDate() + 1);
                                        let mes = new Date().getUTCMonth() + 1;
                                        let fechaMañana = mes + "-" + dia;
                                        let fechaNacimiento = fecha.slice(5);
                                        if (regEx.test(fecha) && fechaMañana !== fechaNacimiento) {


                                        $(thisInput).siblings(".error-message").text("");
                                        $(thisInput).removeClass("invalidText").addClass("correct");
                                        //                               
                                        setTimeout(() => {
                                        $(thisInput).removeClass("correct");
                                        }, 3700);
                                        } else {
                                        $(thisInput).removeClass("correct").addClass("invalidText");
                                        $(thisInput).siblings(".error-message").text("Fecha no valida");
                                        setTimeout(() => {
                                        //                                     $(thisInput).removeClass("invalidText");

                                        }, 3700);
                                        }

                                        }

                                        function validarCurp(thisInput) {
                                        const regExp = /[A-Z]{1}[AEIOU]{1}[A-Z]{2}[0-9]{2}(0[1-9]|1[0-2])(0[1-9]|1[0-9]|2[0-9]|3[0-1])[HM]{1}(AS|BC|BS|CC|CS|CH|CL|CM|DF|DG|GT|GR|HG|JC|MC|MN|MS|NT|NL|OC|PL|QT|QR|SP|SL|SR|TC|TS|TL|VZ|YN|ZS|NE)[B-DF-HJ-NP-TV-Z]{3}[0-9A-Z]{1}[0-9]{1}/;
                                        const texto = $(thisInput).val();
                                        if (regExp.test(texto)) {

                                        $(thisInput).removeClass("invalidText").addClass("correct");
                                        $(thisInput).siblings(".error-message").text("Correcto");
                                        setTimeout(() => {
                                        $(thisInput).removeClass("correct");
                                        }, 3700);
                                        } else {
                                        $(thisInput).removeClass("correct").addClass("invalidText");
                                        $(thisInput).siblings(".error-message").text("CURP no valida");
                                        //                                setTimeout(() => {
                                        //                                    //                                     $(thisInput).removeClass("invalidText");
                                        //                                    $(thisInput).siblings(".error-message").text("");
                                        //                                }, 3700);
                                        }

                                        }

                                        function validarRol(thisInput) {
                                        const valor = $(thisInput).val();
                                        if (valor != 0) {
                                        $(thisInput).removeClass("invalidText").addClass("correct");
                                        setTimeout(() => {
                                        $(thisInput).removeClass("correct");
                                        }, 3700);
                                        } else {
                                        $(thisInput).removeClass("correct").addClass("invalidText");
                                        $(thisInput).siblings(".error-message").text("rol no valido");
                                        setTimeout(() => {
                                        //                                     $(thisInput).removeClass("invalidText");
                                        $(thisInput).siblings(".error-message").text("");
                                        }, 3700);
                                        }
                                        }

                                        function validarCalle(thisInput) {
                                        const regExp = /([^\u0000-\u0040\u005B-\u0060\u007B-\u00BF\u02B0-\u036F\u00D7\u00F7\u2000-\u2BFF])+/;
                                        let cadena = $(thisInput).val();
                                        if (regExp.test(cadena) && cadena.length < 40) {
                                        console.log("Calle valida");
                                        $(thisInput).removeClass("invalidText").addClass("correct");
                                        $("#calleMensaje").text("");
                                        setTimeout(() => {
                                        $(thisInput).removeClass("correct");
                                        }, 5000);
                                        } else {
                                        $(thisInput).addClass("invalidText");
                                        $("#calleMensaje").text("Calle no valida");
                                        console.log("Correo no valido");
//                        setTimeout(() => {
//
//                        $("#emailMessage").text("");
////                        $(thisInput).removeClass("invalidText");
//                        }, 5000);
                                        }
                                        }


        </script>


        <script th:inline="javascript">

            function cargarRol(){
            $("#rolddl").val([[${Usuario.rol.idRol}]]);
            }

            $("#btnFoto").on("click", () => {
            $("#inputImg").click();
            });
            $("#inputImg").on("change", () => {
            $("#btnSubImg").click();
            })
        </script>
        <script th:inline="javascript">

                    const myModal = document.getElementById('my-Modal');
//                    const myInput = document.getElementById('myInput')

            myModal.addEventListener('shown.bs.modal', () => {
            myInput.focus();
            });
            const modalDirecciones = document.getElementById('ModalDireccion');
//                    const myInput = document.getElementById('myInput')

            modalDirecciones.addEventListener('shown.bs.modal', () => {
            myInput.focus()
            });
            function paisddl() {

            if ($("#ddlPais").val() == 0) {
            $("#ddlEstado").empty();
            $("#ddlEstado").append(" <option>Selecciona un Estado</option>");
            } else {

            //ajax para manejra peticiones asincronas

            $.ajax({

            url: "http://localhost:8081/api/estado/pais/" + $("#ddlPais").val(), //url de la peticion
                    method: "GET", //tipo de accion
                    dataType: 'json', // tipos de datos
                    //Cuando la peticion fue exitosa:
                    success: function (data, textStatus, jqXHR) {
                    if (data.Correct) {
                    //vacia el ddl para que no se dupliquen al ejecutar varias veces la acción
                    $("#ddlEstado").empty();
                    $("#ddlEstado").append(" <option value=0>Selecciona un Estado</option>");
//                    $("#ddlMunicipio").empty();
//                    $("#ddlMunicipio").append(" <option value=0>Selecciona un Municipio</option>");
//                    $("#ddlColonia").empty();
//                    $("#ddlColonia").append(" <option value=0>Selecciona una Colonia</option>");
                    //itera sobre la lista de objetos y ejecuta la funcion de al lado
                    $.each(data.Object, function (i, estado) {
                    //En el input con el id: ddlEstado agrega una option con valores traidos de la petición
                    $("#ddlEstado").append("<option value=" + estado.idEstado + ">" + estado.nombre + "</option>");
                    });
                    }
                    },
                    //Cuando hubo error en la petición 
                    error: function (jqXHR, textStatus, errorThrown) {
                    alert(textStatus);
                    }





            });
            }




            }



            function cambiarEstado() {

            if ($("#ddlEstado").val() == 0) {
            $("#ddlMunicipio").empty();
            $("#ddlMunicipio").val(0);
            $("#ddlMunicipio").append(" <option value=0>Selecciona un Municipio</option>");
            } else {
            $.ajax({
            url: "http://localhost:8081/api/municipio/estado/" + $("#ddlEstado").val(),
                    method: "GET", //tipo de accion
                    dataType: 'json', // tipos de datos
                    success: function (data, textStatus, jqXHR) {

                    if (data.Correct) {
                    $("#ddlMunicipio").empty();
                    $("#ddlMunicipio").append(" <option value=0>Selecciona un Municipio</option>");
                    $.each(data.Object, function (i, municipio) {
                    //                                                En el input con el id: ddlEstado agrega una option con valores traidos de la petición
                    $("#ddlMunicipio").append("<option value=" + municipio.idMunicipio + ">" + municipio.nombre + "</option>");
                    });
                    }

                    },
                    error: function () {
                    alert("Hubo un error...");
                    }
            });
            }
            }


            function cambiaMunicipio() {

            if ($("#ddlMunicipio").val() == 0) {
            $("#ddlColonia").empty();
            $("#ddlColonia").append(" <option value=0>Selecciona la Colonia</option>");
            } else {
            //                                
            $.ajax({
            url: "http://localhost:8081/api/colonia/municipio/" + $("#ddlMunicipio").val(),
                    method: "GET",
                    dataType: 'json',
                    success: function (data, textStatus, jqXHR) {
                    if (data.Correct) {
                    $("#ddlColonia").empty();
                    $("#ddlColonia").append(" <option value=0>Selecciona la Colonia</option>");
                    $.each(data.Object, function (i, colonia) {
                    $("#ddlColonia").append("<option value=" + colonia.idColonia + ">" + colonia.nombre + "</option>");
                    });
                    //                                             
                    }
                    ;
                    //                                         if (data.Correct) {
                    //                                            $("#ddlMunicipio").empty();
                    //                                            $("#ddlMunicipio").append(" <option value=0>Selecciona un Municipio</option>");
                    //                                            $.each(data.Objects, function (i, municipio) {
                    ////                                                En el input con el id: ddlEstado agrega una option con valores traidos de la petición
                    //                                                $("#ddlMunicipio").append("<option value=" + municipio.idMunicipio + ">" + municipio.nombre + "</option>");
                    //                                            });
                    //                                        }
                    },
                    error: function () {
                    alert("Algo salió mal...");
                    }
            });
            }
            }

            function EditarDireccion(idUsuario, idDireccion) {
            $("#Dircalle,#noExterior,#noInterior").val("");
            $("#ddlPais").val("0");
            $.ajax({
            url: "/Usuario/direccionForm/" + idUsuario,
                    type: "GET",
                    dataType: "json",
                    success: function (data) {
                    $.each(data.Object.direcciones, (i, direccion) => {
                    if (parseInt(direccion.idDireccion) === parseInt(idDireccion)) {
                    console.log(direccion.calle);
                    $("#ddlEstado").val("0");
                    $("#ddlColonia").val("0");
                    $("#ddlMunicipio").val("0");
                    $("#hiddenDirId").val(direccion.idDireccion);
                    $("#Dircalle").val(direccion.calle);
                    $("#noExterior").val(direccion.numeroExterior);
                    $("#noInterior").val(direccion.numeroInterior);
                    $("#idCol").val(direccion.colonia.idColonia);
                    $("#ddlPais").val(direccion.colonia.municipio.estado.pais);
//                                                            console.log( direccion.colonia.municipio.estado.pais.nombre);
                    idPais = $("#ddlPais").val(direccion.colonia.municipio.estado.pais.idPais).attr("selected", true);
                    if (idPais.length > 0) {
                    $("#ddlEstado").append("<option value=" + direccion.colonia.municipio.estado.idEstado + ">" + direccion.colonia.municipio.estado.nombre + "</option>");
                    $("#ddlEstado").val(direccion.colonia.municipio.estado.idEstado).attr("selected", true);
                    }
//                    if ($("#ddlEstado").val(direccion.colonia.municipio.estado.idEstado) == 1) {

//                    }
                    if ($("#ddlColonia").children("option").length < 2){
                    $("#ddlColonia").append("<option value=" + direccion.colonia.idColonia + " >" + direccion.colonia.nombre + "</option>");
                    }
                    $("#ddlColonia").val(direccion.colonia.idColonia);
                    console.log($("#ddlMunicipio").children("option").length);
                    if ($("#ddlMunicipio").children("option").length < 2){
                    $("#ddlMunicipio").append("<option value=" + direccion.colonia.municipio.idMunicipio + " >" + direccion.colonia.municipio.nombre + "</option>");
                    }
                    $("#ddlMunicipio").val(direccion.colonia.municipio.idMunicipio);
//                    }

                    }
//                    console.log(idPais.length);
//                                                            $("#ddlEstado").val(direccion.colonia.municipio.estado.idEstado);
//                                                          $("#ddlEstado").empty();
//                                                         $("#ddlColonia").empty();
                    });
                    },
                    error: function (jqXHR, textStatus, errorThrown) {
                    console.error("Error en AJAX:", textStatus, errorThrown);
                    }
            });
            }







        </script>

        <script th:if="${ErroresDireccion == true}">
            () => {

                $("#ddlEstado").val("0");
                $("#ddlColonia").val("0");
                $("#ddlMunicipio").val("0");
                $("#hiddenDirId").val("");
                $("#Dircalle").val("");
                $("#noExterior").val("");
                $("#noInterior").val("");
                $("#idCol").val("");
                $("#ddlPais").val();
            }



        </script>


        <script>

            $("#btnSubmitDireccion").on("load", () => {
            $("#hiddenDirId").removeData();
            });
//            $("#modalDireccion").on("load", () => {
//                
//            });




            //CAMBIAR EL VALOR QUE YA SE ENCONTRABA EN EL INPUT HIDDEN CREADO CON THYMELEAF
            function AgregarDireccion() {
            $("#Dircalle,#noExterior,#noInterior,#idCol").val("");
            $("#ddlPais").val("0");
//                paisddl();
//                cambiarEstado();
//                cambiaMunicipio();
//                $("#ddlEstado").append("<option value=" + estado.idEstado + ">" + estado.nombre + "</option>");
            $("#ddlEstado").val(0);
            $("#ddlColonia").val(0);
            $("#ddlMunicipio").val("0");
            $("#hiddenDirId").val("0");
            }
        </script>
        <script>
            function EliminarDireccion(idUsuario, idDireccion){

            Swal.fire({
            title: "Estas segur@?",
                    text: "No pordrás revertir el cambio!",
                    icon: "warning",
                    showCancelButton: true,
                    confirmButtonColor: "#3085d6",
                    cancelButtonColor: "#d33",
                    width:"18rem",
                    confirmButtonText: "Eliminar!"
            }).then((result) => {
            if (result.isConfirmed) {
            window.location.href = "/Usuario/direccion/delete/" + idDireccion + "/" + idUsuario;
            }
            });
            }

        </script>
        <script th:if="${borrarDireccion}"th:inline="javascript">
            if ([[${borrarDireccion.Correct}]]){
            let timerInterval;
            Swal.fire({
            title: "Eliminado",
                    html: "Cerrando en <b></b> milisegundos.",
                    timer: 2100,
                    position:'bottom-end',
                    toast:true,
                    timerProgressBar: true,
                    didOpen: () => {
            Swal.showLoading();
            const timer = Swal.getPopup().querySelector("b");
            timerInterval = setInterval(() => {
            timer.textContent = `${Swal.getTimerLeft()}`;
            }, 100);
            },
                    willClose: () => {
            clearInterval(timerInterval);
            }
            }).then((result) => {
            if (result.dismiss === Swal.DismissReason.timer) {
            console.log("I was closed by the timer");
            }
            });
            } else{
            let timerInterval;
            Swal.fire({
            title: "Error al borrar!",
                    html: "I will close in <b></b> milliseconds.",
                    timer: 2000,
                    position:'bottom-end',
                    toast:true,
                    timerProgressBar: true,
                    didOpen: () => {
            Swal.showLoading();
            const timer = Swal.getPopup().querySelector("b");
            timerInterval = setInterval(() => {
            timer.textContent = `${Swal.getTimerLeft()}`;
            }, 100);
            },
                    willClose: () => {
            clearInterval(timerInterval);
            }
            }).then((result) => {
            if (result.dismiss === Swal.DismissReason.timer) {
            console.log("I was closed by the timer");
            }
            });
            }

        </script>

        <script th:if="${Errores} OR ${ErroresEditarDireccion} ">
            function cerrarModal(idUsuario){
            window.location.href = "/Usuario/detail/" + idUsuario;
            }
            $(document).ready(function(){

            $(document).keydown(function(event){
            console.log(event.key);
            console.log(event.wich);
            if (event.key === 'Escape' || event.keyCode === 27){
            location.reload();
            }

            });
            });
        </script>

        <!--        <script th:if="${Errores != null}" th:inline="javascript">
        //            $("#input-nombre").val("hola");
                    $("#input-nombre").val([[${Usuario.nombre}]]);
                </script>-->

        <script th:if="${ErroresUsuario}==true OR ${Errores}">

            $("#btnEditarUsuario").click();
        </script>
        <script th:if="${ErroresEditarDireccion}">

            $("#btnEditarDireccion").click();
        </script>
        <script th:if="${ErroresUsuario}==true OR ${Errores}">

            $("#btnEditarUsuario").click();
        </script>


        <!--        <script th:if="${ErroresDireccion}">
        
                    $("#btnSubmitDireccion").click();
                </script>-->






    </body>
</html>
